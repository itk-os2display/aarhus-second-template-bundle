/**
 * @name ItkAarhusSecondTemplateBundle
 * @version v1.0.0
 * @link https://github.com/itk-os2display/aarhus-second-template-bundle
 */
angular.module("aarhusSecondTemplates",[]),angular.module("aarhusSecondTemplates").config([function(){}]),angular.module("aarhusSecondTemplates").directive("contactTool",["mediaFactory","busService","$timeout",function(i,o,n){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",tool:"="},link:function(s){var l=null;function t(){var e=s.slide.media,t=Object.values(s.slide.options.contacts).reduce(function(e,t){return t.imageId&&(e[t.imageId]=t.id),e},{}),i=[];for(var o in e)if(e.hasOwnProperty(o)){var n=e[o],a=t[o];a&&(i.push(n),s.slide.options.contacts[a].imageId=i.indexOf(n))}s.slide.media=i}s.step=null,s.selectedMedia=[],s.selectedMediaType="image",s.slide.options.contacts||(s.slide.options.contacts={}),s.contactLength=function(){return Object.keys(s.slide.options.contacts).length},s.addContact=function(){if(!(6<=s.contactLength())){var e=Date.now();s.slide.options.contacts[e]={id:e,name:"",title:"",phone:"",email:""}}},s.removeContact=function(e){delete s.slide.options.contacts[e.id],t()},s.removeMedia=function(e){s.slide.options[e]=null,t()},s.backgroundPicker=function(e){l=e,s.step="background-picker"},s.pickFromMedia=function(){l&&""!==l.imageId&&null!==l.imageId&&void 0!==l.imageId&&(s.selectedMedia=[s.slide.media[l.imageId]]),s.step="pick-from-media"},s.pickFromComputer=function(){s.step="pick-from-computer"},s.back=function(){s.selectedMedia=[],s.step=null,l=null};s.$on("mediaOverview.selectMedia",function(e,t){!function(e){var t=[],i=!1,o=null;for(var n in s.slide.media)if(s.slide.media.hasOwnProperty(n)){var a=s.slide.media[n];a.id===e.id&&(i=!0,o=parseInt(n)),t.push(a)}i||(t.push(e),o=t.length-1),l.imageId=o,s.step=null,s.slide.media=t}(t)}),s.$on("mediaUpload.uploadSuccess",function(e,t){s.step=null,i.getMedia(t.id).then(function(e){n(function(){s.slide.media.push(e),l.imageId=s.slide.media.indexOf(e)})},function(e){o.$emit("log.error",{cause:e,msg:"Kunne ikke tilfÃ¸je media."})})})},templateUrl:"/bundles/itkaarhussecondtemplate/apps/aarhusSecondTemplates/contact-tool.html"}}]),angular.module("aarhusSecondTemplates").directive("tableTool",["busService",function(e){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",tool:"="},link:function(o){o.slide.options.table||(o.slide.options.table={title:"",headers:[],rows:[]}),o.addColumn=function(e){var t={type:e=void 0!==e?e:"text",value:""};o.slide.options.table.headers.push(t);for(var i=0;i<o.slide.options.table.rows.length;i++)o.slide.options.table.rows[i].push(angular.copy(t))},o.removeColumn=function(i){for(var e in o.slide.options.table.headers=o.slide.options.table.headers.filter(function(e,t){return t!==i}),o.slide.options.table.rows){var t=o.slide.options.table.rows[e];t=t.filter(function(e,t){return t!==i}),o.slide.options.table.rows[e]=t}},o.addRow=function(){for(var e=[],t=0;t<o.slide.options.table.headers.length;t++){var i={type:o.slide.options.table.headers[t].type,value:""};e.push(i)}o.slide.options.table.rows.push(e)},o.removeRow=function(i){o.slide.options.table.rows=o.slide.options.table.rows.filter(function(e,t){return t!==i})}},templateUrl:"/bundles/itkaarhussecondtemplate/apps/aarhusSecondTemplates/table-tool.html"}}]);