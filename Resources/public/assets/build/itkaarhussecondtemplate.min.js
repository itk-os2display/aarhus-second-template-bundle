/**
 * @name ItkAarhusSecondTemplateBundle
 * @version v1.0.0
 * @link https://github.com/itk-os2display/aarhus-second-template-bundle
 */
angular.module("aarhusSecondTemplates",[]),angular.module("aarhusSecondTemplates").config([function(){}]),angular.module("aarhusSecondTemplates").directive("contactTool",["mediaFactory","busService","$timeout",function(o,i,a){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",tool:"="},link:function(r){var l=null;function t(){var e=r.slide.media,t=Object.values(r.slide.options.contacts).reduce(function(e,t){return null!==t.imageId&&void 0!==t.imageId&&(e[t.imageId]||(e[t.imageId]=[]),e[t.imageId].push(t.id)),e},{});for(var o in r.slide.options.contacts)r.slide.options.contacts.hasOwnProperty(o)&&(r.slide.options.contacts[o].imageId=null);var i=[];for(var a in e)if(e.hasOwnProperty(a)){var n=!1,l=e[a],s=t[a];for(var d in s)s.hasOwnProperty(d)&&(d=s[d])&&(n||(i.push(l),n=!0),r.slide.options.contacts[d].imageId=i.indexOf(l))}r.slide.media=i}r.step=null,r.selectedMedia=[],r.selectedMediaType="image",r.slide.options.contacts||(r.slide.options.contacts={}),r.contactLength=function(){return Object.keys(r.slide.options.contacts).length},r.addContact=function(){var e;6<=r.contactLength()||(e=Date.now(),r.slide.options.contacts[e]={id:e,name:"",title:"",phone:"",email:""})},r.removeContact=function(e){delete r.slide.options.contacts[e.id],t()},r.removeMedia=function(e){r.slide.options.contacts[e].imageId=null,t()},r.backgroundPicker=function(e){l=e,r.step="background-picker"},r.pickFromMedia=function(){l&&""!==l.imageId&&null!==l.imageId&&void 0!==l.imageId&&(r.selectedMedia=[r.slide.media[l.imageId]]),r.step="pick-from-media"},r.pickFromComputer=function(){r.step="pick-from-computer"},r.back=function(){r.selectedMedia=[],r.step=null,l=null};r.$on("mediaOverview.selectMedia",function(e,t){!function(e){var t,o=[],i=!1,a=null;for(var n in r.slide.media){r.slide.media.hasOwnProperty(n)&&((t=r.slide.media[n]).id===e.id&&(i=!0,a=parseInt(n)),o.push(t))}i||(o.push(e),a=o.length-1),l.imageId=a,r.step=null,r.slide.media=o}(t)}),r.$on("mediaUpload.uploadSuccess",function(e,t){r.step=null,o.getMedia(t.id).then(function(e){a(function(){r.slide.media.push(e),l.imageId=r.slide.media.indexOf(e)})},function(e){i.$emit("log.error",{cause:e,msg:"Kunne ikke tilfÃ¸je media."})})}),r.availableSizes=[{name:"Normal",value:"normal"},{name:"Stor",value:"large"}]},templateUrl:"/bundles/itkaarhussecondtemplate/apps/aarhusSecondTemplates/contact-tool.html"}}]),angular.module("aarhusSecondTemplates").directive("tableTool",["busService",function(e){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",tool:"="},link:function(i){i.slide.options.table||(i.slide.options.table={title:"",headers:[],rows:[]}),i.addColumn=function(e){var t={type:e=void 0!==e?e:"text",value:""};i.slide.options.table.headers.push(t);for(var o=0;o<i.slide.options.table.rows.length;o++)i.slide.options.table.rows[o].push(angular.copy(t))},i.removeColumn=function(o){for(var e in i.slide.options.table.headers=i.slide.options.table.headers.filter(function(e,t){return t!==o}),i.slide.options.table.rows){var t=(t=i.slide.options.table.rows[e]).filter(function(e,t){return t!==o});i.slide.options.table.rows[e]=t}},i.addRow=function(){for(var e=[],t=0;t<i.slide.options.table.headers.length;t++){var o={type:i.slide.options.table.headers[t].type,value:""};e.push(o)}i.slide.options.table.rows.push(e)},i.removeRow=function(o){i.slide.options.table.rows=i.slide.options.table.rows.filter(function(e,t){return t!==o})},i.availableSizes=[{name:"Normal",value:"normal"},{name:"Stor",value:"large"}],i.timepickerConfig={lang:"da",format:"d/m/Y",timepicker:!1,scrollMonth:!1,scrollTime:!1}},templateUrl:"/bundles/itkaarhussecondtemplate/apps/aarhusSecondTemplates/table-tool.html"}}]);