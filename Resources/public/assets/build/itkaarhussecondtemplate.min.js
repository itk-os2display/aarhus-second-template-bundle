/**
 * @name ItkAarhusSecondTemplateBundle
 * @version v1.0.0
 * @link https://github.com/itk-os2display/aarhus-second-template-bundle
 */
angular.module("aarhusSecondTemplates").directive("contactTool",["mediaFactory","busService","$timeout",function(i,o,n){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",tool:"="},link:function(l){var s=null;function t(){var e=l.slide.media,t=Object.values(l.slide.options.contacts).reduce(function(e,t){return t.imageId&&(e[t.imageId]=t.id),e},{}),i=[];for(var o in e)if(e.hasOwnProperty(o)){var n=e[o],a=t[o];a&&(i.push(n),l.slide.options.contacts[a].imageId=i.indexOf(n))}l.slide.media=i}l.step=null,l.selectedMedia=[],l.selectedMediaType="image",l.slide.options.contacts||(l.slide.options.contacts={}),l.contactLength=function(){return Object.keys(l.slide.options.contacts).length},l.addContact=function(){if(!(6<=l.contactLength())){var e=Date.now();l.slide.options.contacts[e]={id:e,name:"",title:"",phone:"",email:""}}},l.removeContact=function(e){delete l.slide.options.contacts[e.id],t()},l.removeMedia=function(e){l.slide.options[e]=null,t()},l.backgroundPicker=function(e){s=e,l.step="background-picker"},l.pickFromMedia=function(){s&&""!==s.imageId&&null!==s.imageId&&void 0!==s.imageId&&(l.selectedMedia=[l.slide.media[s.imageId]]),l.step="pick-from-media"},l.pickFromComputer=function(){l.step="pick-from-computer"},l.back=function(){l.selectedMedia=[],l.step=null,s=null};l.$on("mediaOverview.selectMedia",function(e,t){!function(e){var t=[],i=!1,o=null;for(var n in l.slide.media)if(l.slide.media.hasOwnProperty(n)){var a=l.slide.media[n];a.id===e.id&&(i=!0,o=parseInt(n)),t.push(a)}i||(t.push(e),o=t.length-1),s.imageId=o,l.step=null,l.slide.media=t}(t)}),l.$on("mediaUpload.uploadSuccess",function(e,t){l.step=null,i.getMedia(t.id).then(function(e){n(function(){l.slide.media.push(e),s.imageId=l.slide.media.indexOf(e)})},function(e){o.$emit("log.error",{cause:e,msg:"Kunne ikke tilfÃ¸je media."})})})},templateUrl:"/bundles/itkaarhussecondtemplate/apps/aarhusSecondTemplates/contact-tool.html"}}]),angular.module("aarhusSecondTemplates").directive("tableTool",["busService",function(e){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",tool:"="},link:function(t){t.slide.options.table||(t.slide.options.table={title:"",headers:["","","",""],rows:[[{type:"date",value:null},"","",""]]}),t.addRow=function(){t.slide.options.table.rows.push(["","","",""]),console.log(t.slide.options.table.rows)},t.removeRow=function(e){console.log(e),t.slide.options.table.rows.splice(e,1)}},templateUrl:"/bundles/itkaarhussecondtemplate/apps/aarhusSecondTemplates/table-tool.html"}}]);